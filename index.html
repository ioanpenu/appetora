<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Appetora ‚Äî Weekly meal planner</title>
  <style>
    :root{
      /* PaletƒÉ pastel ‚Äì inspiratƒÉ din referin»õƒÉ */
      --bg:#f7f7fb;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --border:#e6e8ee;

      --coral:   #ff7a7a;  /* coral */
      --orange:  #ff9a5c;  /* apricot */
      --sun:     #ffd166;  /* sunny */
      --mint:    #6ee7c8;  /* mint */
      --teal:    #4cc9b3;  /* teal */
      --indigo:  #6c7cff;  /* indigo */
      --plum:    #c086ff;  /* plum */

      --tile-fg:#0b1220;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font:15px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }

    .wrap{max-width:1100px;margin:24px auto; padding:0 18px}

    /* Header */
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding:8px 0;
    }
    .brand{font-weight:800; font-size:28px; letter-spacing:.2px}
    .right{display:flex; align-items:center; gap:8px}
    .pill{
      font-size:12px; color:var(--muted); border:1px solid var(--border);
      padding:.2rem .5rem; border-radius:999px; background:#fff7; backdrop-filter: blur(2px);
    }

    .btn{
      appearance:none; border:1px solid var(--border); background:#fff; color:#0f172a;
      padding:.55rem .9rem; border-radius:12px; cursor:pointer;
      transition:transform .04s ease, box-shadow .12s ease;
      box-shadow:0 1px 0 rgba(10,10,20,.06);
    }
    .btn:hover{ transform:translateY(-1px); box-shadow:0 6px 14px rgba(0,0,0,.06) }
    .btn.primary{ background:var(--indigo); color:#fff; border-color:transparent }
    .btn.ghost{ background:transparent }

    /* Hero */
    .hero{
      display:grid; gap:12px; padding:18px;
      background:linear-gradient(135deg, #fff, #f1f4ff);
      border:1px solid var(--border); border-radius:22px;
      box-shadow:0 4px 20px rgba(0,0,0,.04);
    }
    .hero h2{ margin:.2rem 0 .4rem; font-size:22px }
    .hero p{ margin:0; color:var(--muted) }

    /* Tile menu */
    .menu{
      display:grid; grid-template-columns:repeat(5,minmax(0,1fr));
      gap:14px; margin-top:18px;
    }
    @media (max-width:980px){ .menu{ grid-template-columns:repeat(3,minmax(0,1fr)); } }
    @media (max-width:600px){ .menu{ grid-template-columns:repeat(2,minmax(0,1fr)); } }

    .tile{
      position:relative; display:grid; place-items:center; gap:8px;
      height:124px; border-radius:24px; padding:10px;
      color:var(--tile-fg); text-align:center; font-weight:650;
      border:1px solid rgba(12,18,32,.06);
      box-shadow:0 8px 24px rgba(0,0,0,.06), inset 0 1px 0 rgba(255,255,255,.6);
      transition:transform .06s ease, box-shadow .12s ease; cursor:pointer;
      user-select:none;
    }
    .tile span{ font-size:13px; font-weight:700 }
    .tile .emoji{ font-size:34px; filter: drop-shadow(0 1px 0 rgba(255,255,255,.6)); }
    .tile:hover{ transform:translateY(-2px); box-shadow:0 16px 36px rgba(0,0,0,.10) }

    .t-planner{  background:linear-gradient(145deg, var(--mint),   #8ef0d6); }
    .t-search{   background:linear-gradient(145deg, var(--teal),   #78e1cf); }
    .t-read{     background:linear-gradient(145deg, var(--sun),    #ffe190); }
    .t-add{      background:linear-gradient(145deg, var(--coral),  #ff9aa1); }
    .t-my{       background:linear-gradient(145deg, var(--indigo), #95a2ff); color:#fff; }

    /* Cards (con»õinut) */
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:18px;
      box-shadow:0 4px 16px rgba(0,0,0,.04); padding:16px;
    }
    .hidden{ display:none !important }
    .muted{ color:var(--muted) }

    /* Link stil pentru ‚Äûghost tiles‚Äù c√¢nd userul nu e logat */
    .tile.locked{ filter:grayscale(.35) brightness(.95); opacity:.65; pointer-events:none }
    .tile.locked::after{
      content:"Sign in first"; position:absolute; bottom:10px; left:0; right:0;
      font-size:11px; color:#0f172a; opacity:.75;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Header -->
    <header class="topbar">
      <div class="brand">Appetora</div>
      <div class="right">
        <span id="lblUser" class="pill hidden"></span>
        <span id="lblUsage" class="pill hidden"></span>
        <button id="btnSignIn"  class="btn">Sign in</button>
        <button id="btnRegister" class="btn ghost">Register</button>
        <button id="btnSignOut" class="btn hidden">Sign out</button>
      </div>
    </header>

    <!-- Hero -->
    <section class="hero">
      <div>
        <h2>Your weekly peek, without the hassle ‚ú®</h2>
        <p class="muted">Add your recipes, then let Appetora pick a balanced plan and auto-build a shopping list.</p>
      </div>
      <div class="right" id="heroCta">
        <button id="ctaRegister" class="btn primary">Create a free account</button>
        <button id="ctaLogin" class="btn">I already have an account</button>
      </div>
    </section>

    <!-- iOS-like tiles -->
    <nav id="tileMenu" class="menu">
      <div class="tile t-planner locked"  data-view="planner"><div class="emoji">üóìÔ∏è</div><span>Planner</span></div>
      <div class="tile t-search  locked"  data-view="search"><div class="emoji">üîé</div><span>Search recipe</span></div>
      <div class="tile t-read    locked"  data-view="read"><div class="emoji">üìñ</div><span>Read recipe</span></div>
      <div class="tile t-add     locked"  data-view="add"><div class="emoji">‚ûï</div><span>Add recipe</span></div>
      <div class="tile t-my      locked"  data-view="my"><div class="emoji">üçΩÔ∏è</div><span>My recipes</span></div>
    </nav>

    <!-- Con»õinutul sec»õiunilor (pƒÉstreazƒÉ-»õi componentele aici) -->
    <section id="view-planner" class="card hidden"></section>
    <section id="view-search"  class="card hidden"></section>
    <section id="view-read"    class="card hidden"></section>
    <section id="view-add"     class="card hidden"></section>
    <section id="view-my"      class="card hidden"></section>
  </div>

  <script>
    // -------------- helpers --------------
    const $  = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    const state = { user:null };

    function show(el){ el.classList.remove('hidden'); }
    function hide(el){ el.classList.add('hidden'); }

    function setTilesLocked(locked){
      $$('#tileMenu .tile').forEach(t => t.classList.toggle('locked', locked));
    }

    function openView(name){
      ['planner','search','read','add','my'].forEach(v=>{
        const el = $('#view-'+v);
        if (!el) return;
        if (v === name) show(el); else hide(el);
      });
      // aici doar mutƒÉm focusul UI; componenta ta existentƒÉ √Æ»ôi poate face populate/render
      // (dacƒÉ ai func»õii existente, le po»õi chema √Æn switch)
    }

    // -------------- auth --------------
    async function fetchJSON(url, opt={}){
      const res = await fetch(url, opt);
      const ct = res.headers.get('content-type') || '';
      const body = ct.includes('application/json') ? await res.json() : await res.text();
      return { status: res.status, body };
    }

    async function refreshMe(){
      const r = await fetchJSON('/api/auth/me', { credentials:'include' });
      if (r.status === 200){
        state.user = r.body.user;
        $('#lblUser').textContent = r.body.user.email;
        show($('#lblUser')); show($('#lblUsage')); // usage poate fi setat de tine
        hide($('#btnSignIn')); hide($('#btnRegister'));
        hide($('#ctaRegister')); hide($('#ctaLogin'));
        show($('#btnSignOut'));
        setTilesLocked(false);
      }else{
        state.user = null;
        hide($('#lblUser')); hide($('#lblUsage'));
        show($('#btnSignIn')); show($('#btnRegister'));
        show($('#ctaRegister')); show($('#ctaLogin'));
        hide($('#btnSignOut'));
        setTilesLocked(true);
      }
    }

    // -------------- events --------------
    // ‚ÄûIconi»õele‚Äù ‚Äì deschid sec»õiuni
    $$('#tileMenu .tile').forEach(t=>{
      t.addEventListener('click', ()=>{
        if (!state.user) return;
        openView(t.getAttribute('data-view'));
      });
    });

    // CTA din hero = acela»ôi lucru cu butoanele din header
    $('#ctaRegister').onclick = () => $('#btnRegister').click();
    $('#ctaLogin').onclick    = () => $('#btnSignIn').click();

    // Simplu flow de demo pentru Sign in / Register (po»õi pƒÉstra loginul tƒÉu existent)
    $('#btnSignIn').onclick = async ()=>{
      const email = prompt('Email:'); if(!email) return;
      const password = prompt('Password:'); if(!password) return;
      const r = await fetchJSON('/api/auth/login', {
        method:'POST',
        headers:{ 'content-type':'application/json' },
        body:JSON.stringify({ email, password }),
        credentials:'include'
      });
      if (r.status === 200){ await refreshMe(); openView('planner'); }
      else alert(r.body?.error || 'Login failed');
    };

    $('#btnRegister').onclick = async ()=>{
      const email = prompt('Email to register:'); if(!email) return;
      const password = prompt('Password:'); if(!password) return;
      const name = email.split('@')[0];
      const r = await fetchJSON('/api/auth/register', {
        method:'POST',
        headers:{ 'content-type':'application/json' },
        body:JSON.stringify({ email, password, name }),
        credentials:'include'
      });
      if (r.status === 200){ await refreshMe(); openView('planner'); }
      else alert(r.body?.error || 'Register failed');
    };

    $('#btnSignOut').onclick = async ()=>{
      await fetchJSON('/api/auth/logout', { method:'POST', credentials:'include' });
      await refreshMe();
      // √Ænchide toate panourile dupƒÉ logout
      ['planner','search','read','add','my'].forEach(v=> hide($('#view-'+v)));
    };

    // -------------- init --------------
    refreshMe();
  </script>
</body>
</html>
